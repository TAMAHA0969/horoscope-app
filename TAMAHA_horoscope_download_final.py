
import streamlit as st
import datetime
import calendar

st.set_page_config(page_title="TAMAHAã®æ˜Ÿåº§ã¨å®¿å‘½æ•°", layout="centered")

st.title("ğŸ”® TAMAHAã®æ˜Ÿåº§ã¨å®¿å‘½æ•°")
name = st.text_input("ãŠåå‰ï¼ˆãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ ã§ã‚‚OKï¼‰", "ã‚²ã‚¹ãƒˆ")
birth_date = st.date_input("ç”Ÿå¹´æœˆæ—¥ã‚’é¸ã‚“ã§ãã ã•ã„", value=datetime.date(2000, 1, 1),
                           min_value=datetime.date(1900, 1, 1), max_value=datetime.date.today())

submit = st.button("è¨ºæ–­ã‚¹ã‚¿ãƒ¼ãƒˆï¼")

if submit:
    def calc_life_path_number(date):
        total = sum(int(d) for d in date.strftime("%Y%m%d"))
        while total > 9 and total not in [11, 22, 33]:
            total = sum(int(d) for d in str(total))
        return total

    def calc_destiny_number(date):
        total = date.day
        if total not in [11, 22, 33]:
            total = sum(int(d) for d in str(total))
        return total

    def calc_mission_number(date):
        total = date.month + date.day
        if total not in [11, 22, 33]:
            total = sum(int(d) for d in str(total))
        return total

    def get_zodiac_sign(date):
        month, day = date.month, date.day
        signs = [
            (120, "å±±ç¾Šåº§"), (219, "æ°´ç“¶åº§"), (321, "é­šåº§"), (420, "ç‰¡ç¾Šåº§"),
            (521, "ç‰¡ç‰›åº§"), (621, "åŒå­åº§"), (722, "èŸ¹åº§"), (823, "ç…å­åº§"),
            (923, "ä¹™å¥³åº§"), (1023, "å¤©ç§¤åº§"), (1122, "è åº§"), (1222, "å°„æ‰‹åº§"), (1231, "å±±ç¾Šåº§")
        ]
        mmdd = month * 100 + day
        for cutoff, sign in signs:
            if mmdd <= cutoff:
                return sign
        return "å±±ç¾Šåº§"

    def get_role(number):
        if number in [1, 6, 9, 11, 22, 33]:
            return "ãƒªãƒ¼ãƒ€ãƒ¼"
        elif number in [2, 4, 7]:
            return "ã‚µãƒãƒ¼ã‚¿ãƒ¼"
        elif number in [3, 5, 8]:
            return "ãƒ ãƒ¼ãƒ‰ãƒ¡ãƒ¼ã‚«ãƒ¼"
        else:
            return "ä¸æ˜"

    def get_role_description(number):
        descriptions = {
            1: "ç‹¬ç«‹å¿ƒãŒå¼·ãã€è‡ªä¿¡ã«ã‚ãµã‚Œã‚‹å‰µé€ çš„ãªãƒªãƒ¼ãƒ€ãƒ¼ã€‚ç›®æ¨™é”æˆã«å‘ã‘ãŸæ¨é€²åŠ›ãŒã‚ã‚Šã¾ã™ã€‚",
            6: "èª¿å’Œã¨è²¬ä»»æ„Ÿã‚’å¤§åˆ‡ã«ã—ã€ä»²é–“ã‚’æ”¯ãˆã‚‹æ¸©ã‹ã„ãƒªãƒ¼ãƒ€ãƒ¼ã§ã™ã€‚",
            9: "ç†æƒ³ã‚’æ²ã’ã€å¯›å®¹ãªå¿ƒã§äººã€…ã‚’å°ããƒ’ãƒ¥ãƒ¼ãƒãƒ‹ãƒ†ã‚£ãƒªãƒ¼ãƒ€ãƒ¼ã€‚",
            2: "ç¸ã®ä¸‹ã®åŠ›æŒã¡ã€‚èª¿å’Œã‚’ä¿ã¡ã€å†·é™ã«ç‰©äº‹ã‚’é€²ã‚ã‚‹ã“ã¨ãŒå¾—æ„ã§ã™ã€‚",
            4: "å®‰å®šã¨å®Ÿç›´ã•ã€‚åœ°é“ãªåŠªåŠ›ã§çµ„ç¹”ã‚’ã—ã£ã‹ã‚Šæ”¯ãˆã¾ã™ã€‚",
            7: "å†…é¢ã®æ¢ç©¶ã‚’é‡è¦–ã—ã€ç›´æ„Ÿã¨æ´å¯ŸåŠ›ã§ã‚µãƒãƒ¼ãƒˆã™ã‚‹å½¹å‰²ã§ã™ã€‚",
            3: "é™½æ°—ã§å‰µé€ çš„ã€‚å ´ã®é›°å›²æ°—ã‚’æ˜ã‚‹ãã—ã€è‡ªç„¶ã¨äººã‚’æƒ¹ãã¤ã‘ã¾ã™ã€‚",
            5: "è‡ªç”±ã¨å¤‰åŒ–ã‚’å¥½ã¿ã€æƒ…å ±é€šã§æŸ”è»Ÿãªã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚¿ãƒ¼ã€‚",
            8: "è¡Œå‹•åŠ›ã¨å®Ÿè¡ŒåŠ›ã«å„ªã‚ŒãŸãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—å‹ãƒ ãƒ¼ãƒ‰ãƒ¡ãƒ¼ã‚«ãƒ¼ã€‚",
            11: "é«˜ã„ç²¾ç¥æ€§ã¨ã‚¤ãƒ³ã‚¹ãƒ”ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æŒã¤ãƒ“ã‚¸ãƒ§ãƒŠãƒªãƒ¼ã€‚äººã‚’å°ãç›´æ„Ÿã®ä½¿ã„æ‰‹ã€‚",
            22: "ä¸–ç•Œã‚’å‹•ã‹ã™å¯èƒ½æ€§ã‚’ç§˜ã‚ãŸãƒã‚¹ã‚¿ãƒ¼ãƒ—ãƒ©ãƒ³ãƒŠãƒ¼ã€‚ãƒ“ã‚¸ãƒ§ãƒ³ã‚’ä¿¡ã˜ã¦è¡Œå‹•ã‚’ã€‚",
            33: "æ·±ã„æ„›ã¨å¥‰ä»•ç²¾ç¥ã§äººã€…ã‚’ç™’ã™ãƒã‚¹ã‚¿ãƒ¼ãƒ’ãƒ¼ãƒ©ãƒ¼ã€‚äººé¡å…¨ä½“ã¸ã®è²¢çŒ®ã‚’ç›®æŒ‡ã—ã¾ã™ã€‚"
        }
        return descriptions.get(number, "å½¹å‰²æƒ…å ±ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚")

    def get_destiny_message(number):
        messages = {
            1: "è‡ªåˆ†ã‚’ä¿¡ã˜ã¦çªãé€²ã‚ï¼å…ˆé§†è€…ã®é“ã¯ã‚ãªãŸãŒåˆ‡ã‚Šæ‹“ãã€‚",
            2: "æ”¯ãˆã‚‹åŠ›ãŒå¼·ã¿ã€‚ç„¡ç†ã«å‰ã«å‡ºãªãã¦ã‚‚ã€é™°ã®åŠ›ãŒå…‰ã‚‹ï¼",
            3: "è‡ªç”±ã¨æ¥½ã—ã•ãŒéµã€‚å‹ã«ã¯ã¾ã‚‰ãšã€è‡ªåˆ†ã®æ„Ÿæ€§ã‚’ä¿¡ã˜ã‚ˆã†ã€‚",
            4: "åœ°é“ãªåŠªåŠ›ãŒå®Ÿã‚’çµã¶ã€‚ç„¦ã‚‰ãšã€ä¸€æ­©ãšã¤ç¢ºå®Ÿã«å‰é€²ã‚’ï¼",
            5: "å¤‰åŒ–ã‚’æã‚Œãšã€æ–°ã—ã„ä¸–ç•Œã¸é£›ã³è¾¼ã‚‚ã†ï¼æŸ”è»Ÿã•ãŒæ­¦å™¨ã€‚",
            6: "äººã‚’æ”¯ãˆã‚‹ã®ã¯ç´ æ™´ã‚‰ã—ã„ã€‚ã§ã‚‚ã€è‡ªåˆ†ã‚’å¤§äº‹ã«ã™ã‚‹ã“ã¨ã‚‚å¿˜ã‚Œãšã«ï¼",
            7: "ä¸€äººã®æ™‚é–“ãŒã‚ãªãŸã‚’æˆé•·ã•ã›ã‚‹ã€‚å†…ãªã‚‹å£°ã«è€³ã‚’å‚¾ã‘ã¦ã€‚",
            8: "æˆåŠŸã‚’ã¤ã‹ã‚€åŠ›ã‚ã‚Šï¼è‡ªä¿¡ã‚’æŒã£ã¦å ‚ã€…ã¨ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—ã‚’ç™ºæ®ã—ã‚ˆã†ã€‚",
            9: "ã™ã¹ã¦ã‚’å—ã‘å…¥ã‚Œã‚‹å¤§ããªæ„›ã‚’æŒã¤äººã€‚æ‰‹æ”¾ã™ã“ã¨ã§æ–°ãŸãªé“ãŒé–‹ãï¼",
            11: "ã‚¤ãƒ³ã‚¹ãƒ”ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§é“ã‚’åˆ‡ã‚Šæ‹“ãç‰¹åˆ¥ãªå°ãæ‰‹ã€‚",
            22: "å¤§ããªå¤¢ã‚’ç¾å®Ÿã«å¤‰ãˆã‚‹åŠ›ã€‚ç¤¾ä¼šçš„æˆåŠŸã®ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«å¤§ã€‚",
            33: "ç„¡å„Ÿã®æ„›ã¨ç™’ã—ã§äººã€…ã‚’åŒ…ã¿ã“ã‚€ã€‚é«˜æ¬¡ã®å¥‰ä»•è€…ã€‚"
        }
        return messages.get(number, "ç‰¹åˆ¥ãªæ„å‘³ã‚’æŒã¤æ•°å­—ã§ã™ã€‚")

    zodiac = get_zodiac_sign(birth_date)
    destiny = calc_destiny_number(birth_date)
    life_path = calc_life_path_number(birth_date)
    mission = calc_mission_number(birth_date)
    role = get_role(destiny)
    role_desc = get_role_description(destiny)
    destiny_msg = get_destiny_message(destiny)

    st.subheader(f"âœ¨ {name}ã•ã‚“ã®çµæœ âœ¨")
    st.markdown(f"**æ˜Ÿåº§ï¼š** {zodiac}")
    st.markdown(f"**å®¿å‘½æ•°ï¼š** {destiny}ï¼ˆ{role}ï¼‰")
    st.markdown(f"**é‹å‘½æ•°ï¼š** {life_path}")
    st.markdown(f"**ä½¿å‘½æ•°ï¼š** {mission}")
    st.markdown(f"ğŸ” **ã‚ãªãŸã®å½¹å‰²ï¼š** {role}ï¼ˆå®¿å‘½æ•°{destiny}ï¼‰ â€“ {role_desc}")
    st.markdown(f"ğŸ“„ **å®¿å‘½æ•°ã‹ã‚‰ã®ã²ã¨ã“ã¨ï¼š** {destiny_msg}")
